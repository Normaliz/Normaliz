dist: xenial

language: cpp

compiler: gcc
  ## - gcc
  ## - clang

#env:
#  - BUILDSYSTEM=autotools-enfnormaliz-nauty
#  - BUILDSYSTEM=autotools-enfnormaliz-nmzintegrate  CONFIGURE_FLAGS="--disable-openmp"
#  - BUILDSYSTEM=autotools-nauty
#  - BUILDSSYTEM=autotools CONFIGURE_FLAGS="--disable-openmp"
#  - BUILDSYSTEM=autotools-makedistcheck
#  - BUILDSYSTEM=autotools-flint-nmzintegrate-nauty

matrix:
  include:
    - os: osx
      compiler: clang
      addons:
        homebrew:
          packages:
            - gmp
            - boost
            - autoconf
            - automake
            - libtool
            - llvm
          update: true
      before_install:
       - export PATH="`brew --prefix`/opt/llvm/bin/:$PATH"
       - export LDFLAGS="-L`brew --prefix`/opt/llvm/lib -Wl,-rpath,`brew --prefix`/opt/llvm/lib"
      env: COMPILER_OVERRIDE=homebrew-llvm BUILDSYSTEM=autotools-nmzintegrate-enfnormaliz-nauty-static CONFIGURE_FLAGS=--enable-openmp
      #after_success:
      # - ./.make-bindist.sh  
#    - os: osx
#      osx_image: xcode8.3
#      compiler: clang
#      env: BUILDSYSTEM=autotools
#    - os: osx
#      osx_image: xcode7.3
#      compiler: clang
#      env: BUILDSYSTEM=autotools-nauty-makedistcheck
#    - os: osx
#      osx_image: xcode6.4
#      compiler: clang
#      env: BUILDSYSTEM=autotools-flint-nmzintegrate
#    ## builds with Linux clang only without OpenMP 
#    ## because of (i) missing libomp.so in trusty
#    ## (ii) problem in Flint
    - os: linux
      compiler: clang
      env: BUILDSYSTEM=autotools-enfnormaliz-nauty
    - os: linux
      compiler: clang
      env: BUILDSYSTEM=autotools-flint-nmzintegrate

branches:
  except:
    - gh-pages

addons:
  apt:
    packages:
      - libgmp-dev
      - libboost-dev
      - autoconf
      - automake
      - libtool
      - time
      - libomp-dev  # for clang

script: ./.travis-build.sh
